<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è®ºå›ä½“å°è¯´åˆ¶ä½œå·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        body {
            background-color: #f5f5f5;
            padding: 20px;
            transition: background-color 0.3s, color 0.3s;
        }
        body.dark-mode {
            background-color: #1a1a1a;
            color: #e0e0e0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .post-form, .post-card, .reply-form {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            transition: background-color 0.3s, box-shadow 0.3s;
        }
        body.dark-mode .post-form,
        body.dark-mode .post-card,
        body.dark-mode .reply-form {
            background-color: #2d2d2d;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        h2 {
            color: #333;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            transition: color 0.3s, border-color 0.3s;
        }
        body.dark-mode h2 {
            color: #e0e0e0;
            border-color: #444;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            color: #666;
            transition: color 0.3s;
        }
        body.dark-mode label {
            color: #b0b0b0;
        }
        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            background-color: white;
            color: #333;
            transition: background-color 0.3s, border-color 0.3s, color 0.3s;
        }
        body.dark-mode input,
        body.dark-mode textarea,
        body.dark-mode select {
            background-color: #3d3d3d;
            border-color: #555;
            color: #e0e0e0;
        }
        body.dark-mode input::placeholder,
        body.dark-mode textarea::placeholder {
            color: #888;
        }
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        button {
            background-color: #4299e1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #3182ce;
        }
        body.dark-mode button {
            background-color: #3182ce;
        }
        body.dark-mode button:hover {
            background-color: #2b6cb0;
        }
        .post-info {
            color: #999;
            font-size: 13px;
            margin-bottom: 10px;
            transition: color 0.3s;
        }
        body.dark-mode .post-info {
            color: #777;
        }
        .post-title {
            font-size: 20px;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 10px;
            transition: color 0.3s;
        }
        body.dark-mode .post-title {
            color: #e0e0e0;
        }
        .post-content {
            line-height: 1.6;
            margin-bottom: 15px;
            transition: color 0.3s;
        }
        body.dark-mode .post-content {
            color: #d0d0d0;
        }
        .reply-item {
            background-color: #f9fafb;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 10px;
            position: relative;
            transition: background-color 0.3s;
        }
        body.dark-mode .reply-item {
            background-color: #333;
        }
        .reply-author {
            font-weight: bold;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: color 0.3s;
        }
        body.dark-mode .reply-author {
            color: #e0e0e0;
        }
        .author-tag {
            background-color: #e53e3e;
            color: white;
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: normal;
        }
        .floor-tag {
            position: absolute;
            top: 15px;
            right: 15px;
            color: #4299e1;
            font-size: 12px;
            font-weight: bold;
            transition: color 0.3s;
        }
        body.dark-mode .floor-tag {
            color: #63b3ed;
        }
        .reply-to {
            color: #718096;
            font-size: 12px;
            margin-bottom: 8px;
            padding-left: 5px;
            border-left: 2px solid #dee2e6;
            transition: color 0.3s, border-color 0.3s;
        }
        body.dark-mode .reply-to {
            color: #999;
            border-color: #555;
        }
        .reply-btn {
            background-color: #f0f8fb;
            color: #4299e1;
            padding: 4px 8px;
            font-size: 12px;
            margin-top: 8px;
        }
        body.dark-mode .reply-btn {
            background-color: #2d3748;
            color: #63b3ed;
        }
        .reply-btn:hover {
            background-color: #e8f4f8;
        }
        body.dark-mode .reply-btn:hover {
            background-color: #3a4656;
        }
        .hidden {
            display: none;
        }
        .custom-setting {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            transition: background-color 0.3s;
        }
        body.dark-mode .custom-setting {
            background-color: #333;
        }
        .custom-setting h3 {
            font-size: 15px;
            color: #4a5568;
            margin-bottom: 10px;
            transition: color 0.3s;
        }
        body.dark-mode .custom-setting h3 {
            color: #b0b0b0;
        }
        .mode-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
            padding: 8px 12px;
            background-color: #4299e1;
            color: white;
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        body.dark-mode .mode-toggle {
            background-color: #3182ce;
        }
        .anonymous-option {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
        }
        .anonymous-option input {
            width: auto;
            margin-top: 2px;
        }
        /* æ–°å¢ï¼šæ¸…ç©ºæ•°æ®æŒ‰é’®æ ·å¼ */
        .clear-data-btn {
            background-color: #e53e3e;
            margin-left: 10px;
        }
        .clear-data-btn:hover {
            background-color: #c53030;
        }
        body.dark-mode .clear-data-btn {
            background-color: #c53030;
        }
        body.dark-mode .clear-data-btn:hover {
            background-color: #a71d2a;
        }
    </style>
</head>
<body>
    <div class="mode-toggle" id="modeToggle">
        <span id="modeIcon">ğŸŒ™</span>
        <span id="modeText">å¤œé—´æ¨¡å¼</span>
    </div>

    <div class="container">
        <!-- å‘å¸–è¡¨å• -->
        <div class="post-form">
            <h2>å‘å¸ƒå¸–å­</h2>
            <div class="anonymous-option">
                <input type="checkbox" id="anonymousPost">
                <label for="anonymousPost">åŒ¿åå‘å¸–ï¼ˆéšè—æ˜µç§°ï¼Œæ˜¾ç¤ºä¸º"åŒ¿åç”¨æˆ·"ï¼‰</label>
            </div>
            <div class="form-group">
                <label for="postTitle">å¸–å­æ ‡é¢˜</label>
                <input type="text" id="postTitle" placeholder="è¯·è¾“å…¥å¸–å­æ ‡é¢˜ï¼ˆå¿…å¡«ï¼‰" required>
            </div>
            <div class="form-group" id="postAuthorGroup">
                <label for="postAuthor">å‘å¸–äºº</label>
                <input type="text" id="postAuthor" placeholder="è¯·è¾“å…¥å‘å¸–äººæ˜µç§°" required>
            </div>
            <div class="form-group">
                <label for="postContent">å¸–å­å†…å®¹</label>
                <textarea id="postContent" placeholder="è¯·è¾“å…¥å¸–å­å†…å®¹" required></textarea>
            </div>
            
            <div class="custom-setting">
                <h3>è‡ªå®šä¹‰è®¾ç½®</h3>
                <div class="form-group">
                    <label for="customPostTime">å‘å¸–æ—¶é—´ï¼ˆé»˜è®¤å½“å‰æ—¶é—´ï¼‰</label>
                    <input type="datetime-local" id="customPostTime">
                </div>
                <div class="anonymous-option">
                    <input type="checkbox" id="unifiedIp">
                    <label for="unifiedIp">æ‰€æœ‰å¸–å­/å›å¸–ä½¿ç”¨ç»Ÿä¸€IPå±åœ°</label>
                </div>
                <div class="form-group">
                    <label for="customPostIp">IPå±åœ°ï¼ˆé»˜è®¤éšæœºï¼Œç»Ÿä¸€æ¨¡å¼ä¸‹ç”Ÿæ•ˆï¼‰</label>
                    <input type="text" id="customPostIp" placeholder="ä¾‹å¦‚ï¼šæ±Ÿè‹å—äº¬ã€ç¦å»ºå¦é—¨">
                </div>
            </div>
            
            <button id="publishPost">å‘å¸ƒå¸–å­</button>
            <button id="clearAllData" class="clear-data-btn">æ¸…ç©ºæœ¬åœ°æ•°æ®</button>
        </div>

        <!-- å¸–å­å±•ç¤ºåŒºåŸŸ -->
        <div id="postDisplay" class="post-card hidden">
            <div class="post-title" id="postTitleDisplay"></div>
            <div class="post-info" id="postMeta"></div>
            <div class="post-content" id="postContentDisplay"></div>
            <button id="showReplyForm">æ·»åŠ å›å¸–</button>
        </div>

        <!-- å›å¸–è¡¨å• -->
        <div id="replyForm" class="reply-form hidden">
            <h2>å‘è¡¨å›å¸–</h2>
            <div class="anonymous-option">
                <input type="checkbox" id="anonymousReply">
                <label for="anonymousReply">åŒ¿åå›å¸–ï¼ˆéšè—æ˜µç§°ï¼Œæ˜¾ç¤ºä¸º"åŒ¿åç”¨æˆ·"ï¼‰</label>
            </div>
            <div id="replyToTip" class="reply-to hidden"></div>
            <div class="form-group" id="replyAuthorGroup">
                <label for="replyAuthor">å›å¸–äºº</label>
                <input type="text" id="replyAuthor" placeholder="è¯·è¾“å…¥ä½ çš„æ˜µç§°" required>
            </div>
            <div class="form-group">
                <label for="replyContent">å›å¸–å†…å®¹</label>
                <textarea id="replyContent" placeholder="è¯·è¾“å…¥å›å¸–å†…å®¹" required></textarea>
            </div>
            
            <div class="custom-setting">
                <h3>å›å¸–è‡ªå®šä¹‰</h3>
                <div class="form-group">
                    <label for="customReplyTime">å›å¸–æ—¶é—´ï¼ˆé»˜è®¤å½“å‰æ—¶é—´ï¼‰</label>
                    <input type="datetime-local" id="customReplyTime">
                </div>
                <div class="form-group">
                    <label for="customReplyIp">ç‹¬ç«‹IPå±åœ°ï¼ˆä¼˜å…ˆäºç»Ÿä¸€æ¨¡å¼ï¼Œå¯é€‰ï¼‰</label>
                    <input type="text" id="customReplyIp" placeholder="ä¾‹å¦‚ï¼šæ±Ÿè‹å—äº¬ã€ç¦å»ºå¦é—¨">
                </div>
            </div>
            
            <button id="submitReply">æäº¤å›å¸–</button>
            <button id="cancelReply" class="reply-btn" style="margin-left: 8px;">å–æ¶ˆå›å¤</button>
        </div>

        <!-- å›å¸–åˆ—è¡¨ -->
        <div id="replyList">
            <h2>å›å¸–åŒº</h2>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let postAuthor = '';
        let replyToTarget = null;
        let unifiedIp = '';
        // æœ¬åœ°å­˜å‚¨é”®å
        const STORAGE_KEY = 'forumData';
        
        // è·å–DOMå…ƒç´ 
        const publishBtn = document.getElementById('publishPost');
        const postDisplay = document.getElementById('postDisplay');
        const postTitleDisplay = document.getElementById('postTitleDisplay');
        const postMeta = document.getElementById('postMeta');
        const postContentDisplay = document.getElementById('postContentDisplay');
        const showReplyBtn = document.getElementById('showReplyForm');
        const replyForm = document.getElementById('replyForm');
        const submitReplyBtn = document.getElementById('submitReply');
        const cancelReplyBtn = document.getElementById('cancelReply');
        const replyList = document.getElementById('replyList');
        const replyToTip = document.getElementById('replyToTip');
        const modeToggle = document.getElementById('modeToggle');
        const modeIcon = document.getElementById('modeIcon');
        const modeText = document.getElementById('modeText');
        const anonymousPost = document.getElementById('anonymousPost');
        const anonymousReply = document.getElementById('anonymousReply');
        const postAuthorGroup = document.getElementById('postAuthorGroup');
        const replyAuthorGroup = document.getElementById('replyAuthorGroup');
        const unifiedIpCheckbox = document.getElementById('unifiedIp');
        const customPostIp = document.getElementById('customPostIp');
        const clearAllDataBtn = document.getElementById('clearAllData');
        
        // éšæœºIPæ± 
        const randomIpAreas = ['æ±Ÿè‹å—äº¬', 'ç¦å»ºå¦é—¨', 'åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿ä¸œæ·±åœ³', 'æµ™æ±Ÿæ­å·', 'å››å·æˆéƒ½'];
        function getRandomIpArea() {
            return randomIpAreas[Math.floor(Math.random() * randomIpAreas.length)];
        }
        
        // è·å–æœ€ç»ˆIPå±åœ°
        function getFinalIp(independentIp = '') {
            if (independentIp.trim()) return independentIp.trim();
            if (unifiedIpCheckbox.checked && unifiedIp.trim()) return unifiedIp.trim();
            return getRandomIpArea();
        }
        
        // æ ¼å¼åŒ–æ—¶é—´
        function formatTime(timeInput) {
            if (!timeInput) return new Date().toLocaleString();
            const date = new Date(timeInput);
            return date.toLocaleString();
        }
        
        // ã€æ ¸å¿ƒåŠŸèƒ½ã€‘ä»æœ¬åœ°å­˜å‚¨è¯»å–æ•°æ®
        function loadDataFromStorage() {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : {
                post: null, // ä¸»å¸–å­æ•°æ®
                replies: [] // å›å¸–åˆ—è¡¨
            };
        }
        
        // ã€æ ¸å¿ƒåŠŸèƒ½ã€‘ä¿å­˜æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨
        function saveDataToStorage(data) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        }
        
        // ã€æ ¸å¿ƒåŠŸèƒ½ã€‘æ¸²æŸ“æœ¬åœ°å­˜å‚¨çš„å¸–å­å’Œå›å¸–
        function renderStoredData() {
            const { post, replies } = loadDataFromStorage();
            
            // æ¸²æŸ“ä¸»å¸–å­
            if (post) {
                postTitleDisplay.textContent = post.title;
                postMeta.innerHTML = `å‘å¸–äººï¼š${post.author} ${post.author === 'åŒ¿åç”¨æˆ·' ? '' : '<span class="author-tag">å¸–ä¸»</span>'} | å‘å¸ƒæ—¶é—´ï¼š${post.time} | IPå±åœ°ï¼š${post.ip}`;
                postContentDisplay.textContent = post.content;
                postDisplay.classList.remove('hidden');
                postAuthor = post.author; // æ¢å¤å¸–ä¸»ä¿¡æ¯
                // æ¢å¤ç»Ÿä¸€IPè®¾ç½®
                unifiedIpCheckbox.checked = post.unifiedIp;
                unifiedIp = post.unifiedIpValue || '';
                customPostIp.value = post.unifiedIpValue || '';
            }
            
            // æ¸²æŸ“å›å¸–åˆ—è¡¨
            replies.forEach((reply, index) => {
                const replyItem = document.createElement('div');
                replyItem.className = 'reply-item';
                replyItem.dataset.floor = index + 1; // æ¥¼å±‚ä»1å¼€å§‹
                
                // å›å¸–äºº
                const replyAuthorEl = document.createElement('div');
                replyAuthorEl.className = 'reply-author';
                replyAuthorEl.textContent = reply.author;
                if (reply.author === postAuthor && reply.author !== 'åŒ¿åç”¨æˆ·') {
                    const tag = document.createElement('span');
                    tag.className = 'author-tag';
                    tag.textContent = 'å¸–ä¸»';
                    replyAuthorEl.appendChild(tag);
                }
                
                // å›å¸–å…ƒä¿¡æ¯
                const replyMeta = document.createElement('div');
                replyMeta.className = 'post-info';
                replyMeta.textContent = `å›å¸–æ—¶é—´ï¼š${reply.time} | IPå±åœ°ï¼š${reply.ip}`;
                
                // å›å¤ç›®æ ‡
                const replyToEl = document.createElement('div');
                if (reply.replyTo) {
                    replyToEl.className = 'reply-to';
                    replyToEl.textContent = `å›å¤ @${reply.replyTo.author}ï¼ˆ${reply.replyTo.floor}æ¥¼ï¼‰`;
                }
                
                // å›å¸–å†…å®¹
                const replyContentEl = document.createElement('div');
                replyContentEl.className = 'post-content';
                replyContentEl.textContent = reply.content;
                
                // æ¥¼å±‚æ ‡è¯†
                const floorTag = document.createElement('div');
                floorTag.className = 'floor-tag';
                floorTag.textContent = `${index + 1}æ¥¼`;
                
                // å›å¤æŒ‰é’®
                const replyBtn = document.createElement('button');
                replyBtn.className = 'reply-btn';
                replyBtn.textContent = 'å›å¤è¯¥å±‚ä¸»';
                replyBtn.addEventListener('click', () => {
                    replyToTarget = {
                        author: reply.author,
                        floor: index + 1
                    };
                    replyToTip.textContent = `å›å¤ @${reply.author}ï¼ˆ${index + 1}æ¥¼ï¼‰`;
                    replyToTip.classList.remove('hidden');
                    replyForm.classList.remove('hidden');
                    replyForm.scrollIntoView({ behavior: 'smooth' });
                });
                
                // ç»„è£…å›å¸–
                replyItem.appendChild(replyAuthorEl);
                replyItem.appendChild(replyMeta);
                if (reply.replyTo) replyItem.appendChild(replyToEl);
                replyItem.appendChild(replyContentEl);
                replyItem.appendChild(floorTag);
                replyItem.appendChild(replyBtn);
                
                replyList.appendChild(replyItem);
            });
        }
        
        // å¤œé—´æ¨¡å¼åˆ‡æ¢
        modeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            modeIcon.textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
            modeText.textContent = isDark ? 'æ—¥é—´æ¨¡å¼' : 'å¤œé—´æ¨¡å¼';
            localStorage.setItem('darkMode', isDark ? 'true' : 'false');
        });
        
        // åˆå§‹åŒ–å¤œé—´æ¨¡å¼
        window.addEventListener('load', () => {
            // åŠ è½½å¤œé—´æ¨¡å¼åå¥½
            const isDark = localStorage.getItem('darkMode') === 'true';
            if (isDark) {
                document.body.classList.add('dark-mode');
                modeIcon.textContent = 'â˜€ï¸';
                modeText.textContent = 'æ—¥é—´æ¨¡å¼';
            }
            // åŠ è½½æœ¬åœ°å­˜å‚¨çš„å¸–å­å’Œå›å¸–
            renderStoredData();
        });
        
        // åŒ¿åé€‰é¡¹åˆ‡æ¢
        anonymousPost.addEventListener('change', () => {
            postAuthorGroup.style.display = anonymousPost.checked ? 'none' : 'block';
            document.getElementById('postAuthor').required = !anonymousPost.checked;
        });
        
        anonymousReply.addEventListener('change', () => {
            replyAuthorGroup.style.display = anonymousReply.checked ? 'none' : 'block';
            document.getElementById('replyAuthor').required = !anonymousReply.checked;
        });
        
        // ç»Ÿä¸€IPå¼€å…³åˆ‡æ¢
        unifiedIpCheckbox.addEventListener('change', () => {
            customPostIp.required = unifiedIpCheckbox.checked;
            if (unifiedIpCheckbox.checked) {
                unifiedIp = customPostIp.value.trim() || getRandomIpArea();
                customPostIp.placeholder = 'ç»Ÿä¸€IPå±åœ°ä¸ºå¿…å¡«é¡¹';
            } else {
                customPostIp.placeholder = 'ä¾‹å¦‚ï¼šæ±Ÿè‹å—äº¬ã€ç¦å»ºç¦å·';
            }
        });
        
        customPostIp.addEventListener('input', () => {
            if (unifiedIpCheckbox.checked) {
                unifiedIp = customPostIp.value.trim();
            }
        });
        
        // å‘å¸ƒå¸–å­ï¼ˆä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨ï¼‰
        publishBtn.addEventListener('click', () => {
            const title = document.getElementById('postTitle').value.trim();
            const author = anonymousPost.checked ? 'åŒ¿åç”¨æˆ·' : document.getElementById('postAuthor').value.trim();
            const content = document.getElementById('postContent').value.trim();
            const customTime = document.getElementById('customPostTime').value;
            const customIp = document.getElementById('customPostIp').value.trim();
            
            if (!title || !content) {
                alert('è¯·å¡«å†™å®Œæ•´çš„å¸–å­ä¿¡æ¯ï¼ˆæ ‡é¢˜ã€å†…å®¹å‡ä¸ºå¿…å¡«ï¼‰ï¼');
                return;
            }
            if (unifiedIpCheckbox.checked && !customIp) {
                alert('ç»Ÿä¸€IPæ¨¡å¼ä¸‹ï¼Œè¯·å¡«å†™IPå±åœ°ï¼');
                return;
            }
            
            // æ„é€ å¸–å­æ•°æ®
            const postData = {
                title,
                author,
                content,
                time: formatTime(customTime),
                ip: getFinalIp(customIp),
                unifiedIp: unifiedIpCheckbox.checked,
                unifiedIpValue: customIp.trim()
            };
            
            // è¯»å–ç°æœ‰æ•°æ®ï¼Œæ›´æ–°å¹¶ä¿å­˜
            const data = loadDataFromStorage();
            data.post = postData; // è¦†ç›–åŸæœ‰å¸–å­ï¼ˆå•å¸–å­æ¨¡å¼ï¼‰
            saveDataToStorage(data);
            
            // åˆ·æ–°é¡µé¢æ¸²æŸ“
            window.location.reload();
        });
        
        // æäº¤å›å¸–ï¼ˆä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨ï¼‰
        submitReplyBtn.addEventListener('click', () => {
            const author = anonymousReply.checked ? 'åŒ¿åç”¨æˆ·' : document.getElementById('replyAuthor').value.trim();
            const content = document.getElementById('replyContent').value.trim();
            const customTime = document.getElementById('customReplyTime').value;
            const customIp = document.getElementById('customReplyIp').value.trim();
            
            if (!content) {
                alert('è¯·å¡«å†™å›å¸–å†…å®¹ï¼');
                return;
            }
            if (!anonymousReply.checked && !author) {
                alert('è¯·å¡«å†™å›å¸–äººæ˜µç§°ï¼');
                return;
            }
            const data = loadDataFromStorage();
            if (!data.post) {
                alert('è¯·å…ˆå‘å¸ƒä¸»å¸–å­ï¼');
                return;
            }
            
            // æ„é€ å›å¸–æ•°æ®
            const replyData = {
                author,
                content,
                time: formatTime(customTime),
                ip: getFinalIp(customIp),
                replyTo: replyToTarget || null // å›å¤ç›®æ ‡ï¼ˆå¯é€‰ï¼‰
            };
            
            // æ·»åŠ åˆ°å›å¸–åˆ—è¡¨å¹¶ä¿å­˜
            data.replies.push(replyData);
            saveDataToStorage(data);
            
            // åˆ·æ–°é¡µé¢æ¸²æŸ“
            window.location.reload();
        });
        
        // æ˜¾ç¤ºå›å¸–è¡¨å•
        showReplyBtn.addEventListener('click', () => {
            replyToTarget = null;
            replyToTip.classList.add('hidden');
            replyForm.classList.remove('hidden');
        });
        
        // å–æ¶ˆå›å¤
        cancelReplyBtn.addEventListener('click', () => {
            replyToTarget = null;
            replyToTip.classList.add('hidden');
            replyForm.classList.add('hidden');
            document.getElementById('replyAuthor').value = '';
            document.getElementById('replyContent').value = '';
            document.getElementById('customReplyTime').value = '';
            document.getElementById('customReplyIp').value = '';
            anonymousReply.checked = false;
            replyAuthorGroup.style.display = 'block';
        });
        
        // æ¸…ç©ºæœ¬åœ°æ•°æ®
        clearAllDataBtn.addEventListener('click', () => {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æœ¬åœ°ä¿å­˜çš„å¸–å­å’Œå›å¸–å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                localStorage.removeItem(STORAGE_KEY);
                window.location.reload();
            }
        });
    </script>
</body>
</html>

